# Class 2: 如何与 LLM 对话 - 要点速览

## 课程信息
- **主题**：从 Prompt 到实战
- **时长**：85 分钟
- **目标**：学会用"系统的语言"跟 LLM 说话

---

## 1️⃣ Warm-up：复习 Class 1（10分钟）

### 上节课核心概念
- 系统 = 输入 → 处理 → 输出
- 数据分为结构化和非结构化
- JSON 和 REST API 让系统互相沟通
- LLM 是一种特殊的系统，处理的是语言
- LLM = 超级胶水，能让语言成为 API

### 关键突破
- LLM 让"自然语言"变成了"系统接口"

### 引导性提问
- 如果 LLM 能听懂自然语言，那我们要**怎样"跟它说话"**才最有效？

### 对比
- ❌ 随便说："帮我写点东西"
- ✅ 精确指令："写一段100字的产品介绍"

### 今日主题
- 学习如何跟 LLM 说**"系统的语言"**

---

## 2️⃣ Prompt 基础：让 LLM 听懂你（15分钟）

### 什么是 Prompt？
- **定义**：Prompt = 你输入给 LLM 的**完整指令**
- 就像给助手下达的工作要求

### 好坏对比
- ❌ **糟糕的 Prompt**：
  - "写作业"
  - 问题：模糊、不可控、结果不稳定

- ✅ **优秀的 Prompt**：
  - "你是助教。提取作业信息，用 JSON 格式输出 {科目, 内容, 截止日期}"
  - 优势：清晰、可控、结果稳定

### 核心要点
- 优秀的 Prompt 能让 LLM 输出**稳定、可控**的结果

### Prompt 的四大组成部分

#### 1️⃣ 角色指令（Role）
- 告诉 LLM 它扮演什么角色
- 示例：
  - "你是一位**助教**"
  - "你是一个**日程整理助手**"
  - "你是**新闻摘要员**"

#### 2️⃣ 任务指令（Task）
- 明确要完成什么任务
- 示例：
  - "请帮我**提取**这段文字中的作业信息"
  - "请**总结**这篇文章的要点"

#### 3️⃣ 格式指令（Format）
- 要求特定的输出格式
- 示例：
  - "用 **JSON 格式**输出"
  - "用**表格**形式展示"
  - "**3 个要点**，每个不超过 20 字"

#### 4️⃣ 限制指令（Constraints）
- 设定边界和约束
- 示例：
  - "**不要**输出任何解释文字"
  - "**只要 JSON**，不要其他内容"
  - "字数**不超过 100 字**"

### 综合示例
- 💡 四个部分组合 = 完整、精确的 Prompt

### 课堂示例：作业提取助手

**完整 Prompt**：
```
你是一名中学作业助手。
请从以下文字中提取课程名称、作业内容和截止日期，
并以 JSON 格式输出。
不要输出任何解释文字，只要 JSON。
```

**输入**：
```
"老师说：本周五前交英语作文，题目是'My Future City'。"
```

**输出**：
```json
{
  "subject": "英语",
  "task": "作文 - My Future City",
  "due_date": "周五"
}
```

**总结**：
- ✅ 角色 + 任务 + 格式 + 限制 = 稳定的结构化输出

### 小组活动（5分钟）
- **任务**：从微信群聊中提取今天的课程安排
- **要求**：
  1. 两人一组，写出完整 Prompt
  2. 包含：角色、任务、格式、限制
  3. 比较不同组版本

- **提示**：输出的 JSON 应该包含哪些字段？
  - 例如：课程名、时间、地点、老师...

---

## 3️⃣ LLM 输出结构化结果（20分钟）

### 为什么需要结构化输出？

**问题**：语言是模糊的，但系统需要结构化

**对比**：

- ❌ **自然语言输出**：
  ```
  "这周五要交英语作文，题目是 My Future City。
  另外数学老师说周三带练习册。"
  ```
  - 模糊、难以解析、无法被程序直接使用

- ✅ **JSON 结构化输出**：
  ```json
  [
    {
      "subject": "英语",
      "task": "作文",
      "due_date": "周五"
    },
    {
      "subject": "数学",
      "task": "带练习册",
      "due_date": "周三"
    }
  ]
  ```
  - 清晰、可解析、程序可直接使用

### 核心要点
- LLM 生成 JSON = 把模糊语言 → 机器可读信息

### JSON Schema 思维

**核心思想**：
- 你希望系统返回什么，就要**先告诉它结构**
- 就像填表格：先画好格子，再往里填内容

**三步法**：

1. **Step 1: 设计数据结构**
   ```json
   {
     "user": "",
     "intent": "",
     "action": "",
     "time": ""
   }
   ```

2. **Step 2: 在 Prompt 中说明**
   ```
   "请以 JSON 格式输出，包含 user, intent, action, time"
   ```

3. **Step 3: LLM 按模板输出**
   ```json
   {
     "user": "张三",
     "intent": "提醒",
     "action": "交作业",
     "time": "明天"
   }
   ```

**比喻**：
- 💡 这就像建筑师先画图纸，工人按图纸施工

### 三种输出对比

**任务**：提取作业信息

1. **❌ 普通输出（自然语言）**
   ```
   "需要完成英语作文，周五前交。"
   ```
   - 问题：无法被程序解析

2. **⚠️ JSON 输出（但有错误）**
   ```json
   // 这是英语作业
   {
     "subject": "英语",
     "task": "作文",  // 周五前完成
     "due_date": "周五"
   }
   ```
   - 问题：包含注释，JSON 解析器会报错

3. **✅ 完美的 JSON 输出**
   ```json
   {
     "subject": "英语",
     "task": "作文 - My Future City",
     "due_date": "周五"
   }
   ```
   - ✓ 纯 JSON ✓ 无注释 ✓ 可直接使用

**关键**：
- 在 Prompt 中明确要求"只要 JSON，不要解释"

### 进阶练习

**目标**：让 LLM 从一句话中提取：**谁、要做什么、什么时候**

**输入示例**：
```
"提醒张三明天早上8点交物理作业"
```

**期望输出**：
```json
{
  "user": "张三",
  "intent": "提醒",
  "action": "交物理作业",
  "time": "明天早上8点"
}
```

**试试这些**：
- "帮李四预约周三下午看牙医"
- "提醒全班同学后天带学生证"

---

## 4️⃣ 实操：Dify / Coze 平台项目（25分钟）

### A. 平台选择

#### Dify.ai
- **特点**：Workflow 工作流设计
- **适合**：复杂的多步骤任务
- **优势**：可视化流程、变量传递
- **场景**：数据处理、自动化流程
- 🔗 dify.ai

#### Coze.com
- **特点**：对话式 Bot 构建
- **适合**：多轮对话、聊天机器人
- **优势**：易于集成微信/QQ/Discord
- **场景**：客服机器人、助手应用
- 🔗 coze.com

**本节重点**：
- 💡 今天用 Dify 演示，因为更容易看到数据流动

### B. 项目目标

**创建"小型智能系统"**

**系统流程**：
```
📝 学生输入一句话
→ 🤖 LLM 识别意图
→ 📤 输出 JSON
→ ✅ 执行动作
```

**示例场景**：
- 输入："提醒我周三带数学练习册"
- → LLM 输出：`{"intent":"提醒","subject":"数学","time":"周三","object":"练习册"}`
- → 平台执行动作 → 发送提醒消息或写入任务表

### C. 实践流程（Dify）

#### Step 1: 创建应用
- 打开 Dify.ai，注册/登录
- 点击"创建应用" → 选择 **"Workflow 工作流"**
- 命名：例如"作业提醒助手"

#### Step 2: 添加输入节点
- 拖入 **"Input"** 模块
- 设置输入类型：文本（Text）
- 变量名：`user_input`

#### Step 3: 配置 LLM 节点
- 拖入 **"LLM"** 模块
- 选择模型：DeepSeek / GPT-3.5 / 其他
- 编写 Prompt（见下方）
- 输入变量：`{{user_input}}`

#### Step 4: 添加输出节点
- 拖入 **"Output"** 模块
- 连接 LLM 输出
- 测试运行

**关键点**：
- 💡 每一步都可以看到数据在节点间流动！

### D. Prompt 示例（for Dify）

```
你是一个任务提取助手。

从用户输入中提取以下信息：
- user: 针对谁的任务（如果没提到，写"自己"）
- intent: 意图（提醒/预约/记录等）
- action: 具体要做什么
- time: 时间

必须以纯 JSON 格式输出，不要任何解释。

用户输入：
{{user_input}}

输出格式：
{
  "user": "",
  "intent": "",
  "action": "",
  "time": ""
}
```

**关键点**：
- 使用 `{{user_input}}` 引用输入变量
- 明确要求 JSON 格式
- 提供输出模板
- 强调"不要解释"

### E. 测试案例

**案例 1**：
- 输入："提醒我周三带数学练习册"
- 输出：
  ```json
  {
    "user": "自己",
    "intent": "提醒",
    "action": "带数学练习册",
    "time": "周三"
  }
  ```

**案例 2**：
- 输入："帮李四预约明天下午2点见张老师"
- 输出：
  ```json
  {
    "user": "李四",
    "intent": "预约",
    "action": "见张老师",
    "time": "明天下午2点"
  }
  ```

**案例 3**：
- 输入："记录今天完成了英语作文"
- 输出：
  ```json
  {
    "user": "自己",
    "intent": "记录",
    "action": "完成英语作文",
    "time": "今天"
  }
  ```

### F. 进阶：添加动作节点

**可以添加的动作模块**：

| 动作类型 | 说明 |
|---------|------|
| 📧 发送邮件 | 使用邮件 API 发送提醒 |
| 📝 写入 Notion | 自动创建 Notion 数据库条目 |
| 💬 发送消息 | 通过 Webhook 发到微信/钉钉 |
| 📊 写入表格 | 保存到 Google Sheets / Excel |

**关键理解**：
- **Prompt 的作用**：把语言 → 结构化数据（JSON）
- **动作模块的作用**：把结构化数据 → 实际操作

**注**：
- 📌 今天专注于 Prompt + JSON 输出，动作模块可以课后探索

### G. Coze 平台简介

**特点**：
- 专注于**对话式交互**
- 可以设定**触发关键词**
- 支持**多轮对话记忆**
- 内置**插件系统**（天气、搜索等）
- 容易发布到微信、QQ、Discord

**适合场景**：
- 📱 **微信助手 Bot**："小助手，提醒我明天开会"
- 🎓 **学习答疑 Bot**：持续对话，记住上下文
- 💭 **情绪日记 Bot**：每天记录心情和想法

**对比**：
- 💡 Dify 看重工作流，Coze 看重对话体验

---

## 5️⃣ 展示与延伸（15分钟）

### 小组展示

**展示内容**：
- 你们的项目叫什么？解决什么问题？
- 演示：输入一句话，展示 JSON 输出
- 分享：遇到了什么困难？怎么解决的？

**可能的项目示例**：
- 📚 作业提醒 Bot
- 📅 学习计划生成器
- 💭 情绪日志助手
- 🏃 运动打卡记录
- 🍔 饮食记录分析
- 🎯 目标追踪器

### 同学提问

**常见问题**：

1. **Q: "它是怎么识别时间的？"**
   - A: 💡 LLM 通过训练学会了理解中文的时间表达

2. **Q: "为什么用 JSON 输出？"**
   - A: 💡 因为程序需要结构化数据才能处理

3. **Q: "如果它识别错了怎么办？"**
   - A: 💡 改进 Prompt，添加更多限制条件和示例

4. **Q: "能处理多个任务的输入吗？"**
   - A: 💡 可以！让 LLM 输出数组格式 `[task1, task2, ...]`

### 核心总结

**今天的核心收获**：
- ✅ **Prompt** = 人类写给 LLM 的精确指令
- ✅ 优秀的 Prompt 包含：**角色、任务、格式、限制**
- ✅ 结构化输出（JSON）让 LLM 结果**可被程序使用**
- ✅ **JSON Schema 思维**：先定义结构，再让 LLM 填充
- ✅ Dify/Coze 等平台 = **语言到动作**的桥梁

**关键认知转变**：
> 🔑 今天你们不是在"聊天"，而是在**"编程"**，<br/>
> 只不过用的是**中文**。

### 延伸与展望

**接下来可以做什么？**

#### 📚 进阶学习
- 学习更复杂的 Prompt 技巧（Few-shot, Chain-of-thought）
- 探索 Langchain 等开发框架
- 了解 Function Calling 和 Tool Use

#### 🛠️ 实践项目
- 把你的助手发布到微信/QQ（Coze）
- 连接真实的数据库（Notion / Airtable）
- 加入定时任务（每天提醒）

#### 💡 创意探索
- 为父母/老师创建一个实用工具
- 解决学校/班级的实际问题
- 参加 AI 应用开发比赛

**最终启示**：
> 记住：AI 工具会越来越强大，<br/>
> 但**定义问题**和**设计系统**的能力永远是你的核心竞争力。

---

## 结束语

**恭喜你掌握了"与 LLM 对话"的艺术！**

**从今天开始，你可以**：
- ✅ 写出清晰的 Prompt
- ✅ 让 LLM 输出结构化数据
- ✅ 用平台构建实用的 AI 应用

**💭 最后一个思考**：
> "你想用 LLM 解决生活中的哪个痛点？"

---

## 时间分配参考

| 环节 | 时长 | 要点 |
|-----|------|------|
| Warm-up | 10分钟 | 复习 + 引导 |
| Prompt 基础 | 15分钟 | 四大组成 + 示例 + 活动 |
| 结构化输出 | 20分钟 | JSON Schema + 对比 + 练习 |
| 平台实操 | 25分钟 | Dify 演示 + 测试 |
| 展示延伸 | 15分钟 | 展示 + Q&A + 总结 |
| **总计** | **85分钟** | |

---

## 核心金句

1. "Prompt = 人类写给机器的精确指令"
2. "优秀的 Prompt：角色 + 任务 + 格式 + 限制"
3. "语言是模糊的，但系统需要结构化"
4. "JSON Schema 思维：先定义结构，再让 LLM 填充"
5. "今天你们不是在聊天，而是在编程，只不过用的是中文"
6. "LLM + 平台 = 语言到动作的桥梁"
7. "定义问题和设计系统的能力永远是你的核心竞争力"
